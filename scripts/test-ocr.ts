import { OcrService } from '../src/services/ocrService';
import { logger } from '../src/utils/logger';

/**
 * Script de teste para o sistema OCR
 * Testa o reconhecimento de texto usando uma imagem de exemplo
 * Verifica se o serviço está funcionando corretamente
 */
async function testOcr() {
  try {
    const ocrService = OcrService.getInstance();
    
    // Imagem de teste em base64 - fundo branco com texto "TESTE" em preto
    const sampleImageBase64 = 'data:image/png;base64,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';

    logger.info('Starting OCR test...');
    const recognizedText = await ocrService.recognizeText(sampleImageBase64);
    logger.info('Recognized text:', recognizedText);
    
    // Termina o serviço e libera recursos
    await ocrService.terminate();
    logger.info('OCR test completed successfully');
    process.exit(0);
  } catch (error) {
    logger.error('OCR test failed:', error);
    process.exit(1);
  }
}

// Executa o teste se for chamado diretamente
if (import.meta.url === `file://${process.argv[1]}`) {
  testOcr();
}

